<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrar Partos</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <h1>Registrar Partos</h1>

    <!-- Formulario para registrar un nuevo parto -->
    <form method="POST">
        <label for="galpon">Galpón:</label>
        <select id="galpon" name="galpon" required>
            <option value="">Seleccione un galpón</option>
            {% for galpon in galpones_unicos %}
                <option value="{{ galpon }}">{{ galpon }}</option>
            {% endfor %}
        </select>

        <label for="poza">Poza:</label>
        <select id="poza" name="poza" required>
            <option value="">Seleccione una poza</option>
            {% for poza in pozas_unicas %}
                <option value="{{ poza }}">{{ poza }}</option>
            {% endfor %}
        </select>

        <label for="numero_parto">Número de Parto:</label>
        <select id="numero_parto" name="numero_parto" required>
            <option value="">Seleccione un número de parto</option>
            {% for parto in partos_existentes %}
                <option value="{{ parto.numero_parto }}">{{ parto.numero_parto }}</option>
            {% endfor %}
            <option value="nuevo">Nuevo Parto</option>
        </select>

        <label for="nacidos">Nacidos:</label>
        <input type="number" id="nacidos" name="nacidos" required>

        <label for="muertos_bebes">Muertos Bebés:</label>
        <input type="number" id="muertos_bebes" name="muertos_bebes" required>

        <label for="muertos_reproductores">Muertos Reproductores:</label>
        <input type="number" id="muertos_reproductores" name="muertos_reproductores" required>

        <button type="submit">Registrar Parto</button>
    </form>

    <!-- Botón para buscar partos -->
    <form method="GET" action="{{ url_for('buscar_partos') }}" style="margin-top: 20px;">
        <label for="galpon_buscar">Galpón:</label>
        <select id="galpon_buscar" name="galpon" required>
            <option value="">Seleccione un galpón</option>
            {% for galpon in galpones_unicos %}
                <option value="{{ galpon }}">{{ galpon }}</option>
            {% endfor %}
        </select>

        <label for="poza_buscar">Poza:</label>
        <select id="poza_buscar" name="poza" required>
            <option value="">Seleccione una poza</option>
            {% for poza in pozas_unicas %}
                <option value="{{ poza }}">{{ poza }}</option>
            {% endfor %}
        </select>

        <button type="submit">Buscar Partos</button>
    </form>

    <!-- Tabla para mostrar partos existentes -->
    <h2>Partos Existentes</h2>
    <table>
        <thead>
            <tr>
                <th>Galpón</th>
                <th>Poza</th>
                <th>Número de Parto</th>
                <th>Nacidos</th>
                <th>Muertos Bebés</th>
                <th>Muertos Reproductores</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for parto in partos_existentes %}
                <tr>
                    <td>{{ parto.galpon }}</td>
                    <td>{{ parto.poza }}</td>
                    <td>{{ parto.numero_parto }}</td>
                    <td>{{ parto.nacidos }}</td>
                    <td>{{ parto.muertos_bebes }}</td>
                    <td>{{ parto.muertos_reproductores }}</td>
                    <td>
                        <a href="{{ url_for('editar_parto', id=parto.id) }}">
                            <button>Editar</button>
                        </a>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Botón para regresar al inicio -->
    <a href="{{ url_for('index') }}" style="margin-top: 20px; display: inline-block;">
        <button>Regresar al Inicio</button>
    </a>

    <!-- Mostrar mensajes flash -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}
</body>
</html>
